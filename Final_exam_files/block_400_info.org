#+TITLE: Ανάλυση του block 400 - Παραγωγή Γλυκερόλης
#+AUTHOR: Βιδιάνος Γιαννίτσης
#+cite_export: csl american-chemical-society.csl
#+LATEX_HEADER: \usepackage[a4paper, margin=3cm]{geometry}
\renewcommand{\abstractname}{Περίληψη}
\renewcommand{\tablename}{Πίνακας}
\renewcommand{\figurename}{Σχήμα}
\renewcommand\listingscaption{Κώδικας}

* Διάγραμμα ροής και επεξήγηση
#+CAPTION: Διάγραμμα ροής του block 400
[[file:Διάγραμμα_ροής_και_Επεξήγηση/2023-01-12_16-53-41_screenshot.png]]

Στο block 400 όπως προαναφέρθηκε γίνεται η παραγωγή της γλυκερόλης, ενός από τα δύο βασικά προιόντα στον βιοαντιδραστήρα, του οποίου το προιόν προθερμαίνεται με το ρεύμα της καθαρής γλυκερόλης του block 500. Στο διάγραμμα ροής φαίνονται ο βιοαντιδραστήρας και ο εναλλάκτης θερμότητας που απαιτούνται.

* Σχεδιαστικές Επιλογές
Η βασική σχεδιαστική επιλογή του block αυτού είναι ο τύπος και η λειτουργία του βιοαντιδραστήρα. Για τον εναλλάκτη δεν χρειάζεται να αναφερθεί κάτι καθώς ο σκοπός του είναι βασικά να ψύξει την παραγόμενη γλυκερόλη, το οποίο μπορεί να γίνει ταυτόχρονα με την προθέρμανση του ρεύματος εξόδου του αντιδραστήρα, άρα ήταν μία εύκολη επιλογή που βοηθάει στην ενεργειακή ολοκλήρωση της διεργασίας.

Για τον αντιδραστήρα, ο τύπος που επιλέχθηκε είναι ο αντιδραστήρας RBatch. Αυτό έγινε διότι η λειτουργία διαλείποντος έργου είναι αρκετά διαδεδομένη στους βιοαντιδραστήρες για 2 βασικούς λόγους. Ο πρώτος είναι πως οι αντιδράσεις αυτές έχουν αυτοκαταλυτική φύση άρα σε μία διάταξη συνεχούς ροής, υπάρχει βιομάζα στην έξοδο του αντιδραστήρα αντί να συσσωρεύεται όλη στον αντιδραστήρα, το οποίο μειώνει τον ρυθμό αντίδρασης, ενώ ο δεύτερος είναι ότι σε μία μικροβιακή καλλιέργεια, η οποία λειτουργεί σε μόνιμες συνθήκες, υπάρχει πάντα η πιθανότητα επιμόλυνσης του αντιδραστήρα. Στις περισσότερες περιπτώσεις, η επιμόλυνση αυτή δεν θα δράσει βοηθητικά για τον μικροοργανισμό μας και θα μειώσει τον ρυθμό της αντίδρασης και πιθανότατα την καθαρότητα του προιόντος. Όταν παρατηρηθεί κάτι τέτοιο, θα πρέπει να γίνει ολικό shut down του αντιδραστήρα και να καθαριστεί, το οποίο αποτελεί ένα μεγάλο διάστημα μη παραγωγικού χρόνου μέχρι να ξαναρχίσει το σύστημα σε μόνιμη κατάσταση. Στην περίπτωση του batch αντιδραστήρα, αυτός καθαρίζεται σε κάθε batch και λειτουργεί σε μη μόνιμη κατάσταση, άρα δεν χάνεται χρόνος για την αποκατάσταση της μόνιμης κατάστασης. Επίσης, είναι σημαντικά μικρότερη η πιθανότητα επιμόλυνσης.

Επιπλέον, ένας αντιδραστήρας CSTR πρέπει να λειτουργεί σε τέτοιες συνθήκες ώστε να μην οδηγηθεί σε μόνιμη κατάσταση έκπλυσης, κάτι το ανεπιθύμητο. Αυτό σημαίνει, πως για την τροφοδοσία του αντιδραστήρα μας, ο όγκος που απαιτείται είναι τουλάχιστον 3 φορές μεγαλύτερος αυτού του batch και αυτό είναι χωρίς να ληφθεί υπόψην η αργή κινητική, λόγω της οποίας ο όγκος μπορεί να είναι ακόμη μεγαλύτερος. Θεωρητικά, αυτό θα μπορούσε να λυθεί σε έναν αντιδραστήρα PFR, όμως η ανάδευση είναι ιδιαίτερα σημαντική στις αερόβιες μικροβιακές καλλιέργειες καθώς βοηθάει στην ομοιογένεια και στην συνεχή αιώρηση της βιομάζας, παράγοντες που επιτρέπουν την γρηγορότερη ανάπτυξη της. Επίσης, βελτιώνεται η διασπορά του δυσδιάλυτου οξυγόνου το οποίο πρέπει να υπάρχει και σε ορισμένες περιπτώσεις η μεταφορά του είναι από τα πιο βραδέα στάδια της διεργασίας. Για αυτό, οι αντιδραστήρες PFR δεν προτιμούνται συνήθως για τέτοιες διεργασίες, εκτός από ορισμένες περιπτώσεις κλινών στις οποίες υπάρχει ακινητοποιημένη βιομάζα, μία διεργασία η οποία είναι ιδιαίτερα περίπλοκη στην μελέτη της.

Όλοι αυτοί είναι λόγοι για τους οποίους δεν προτιμάται ένα σύστημα συνεχούς ροής, ακόμη και στην περίπτωση που θέλουμε πολύ υψηλή παραγωγικότητα στον αντιδραστήρα.

Για τις συνθήκες λειτουργίας του, εφόσον έχουμε μία καθαρή καλλιέργεια ενός μικροοργανισμού, οι βέλτιστες συνθήκες λειτουργίας είναι αυστηρά καθορισμένες από τον μικροοργανισμό και είναι τυπικά σε ένα στενό εύρος τιμών το οποίο βρίσκεται από βιβλιογραφία. Για τον μικροοργανισμό Candida glycerinogenes ο οποίος έχει χρησιμοποιηθεί στην διεργασία αυτή, βρέθηκε βιβλιογραφικά πως η βέλτιστη συγκέντρωση γλυκόζης είναι 230-250 g/l, η συγκέντρωση ουρίας 2 g/l, η συγκέντρωση φωσφόρου 55-60 mg/l (προστίθεται στην μορφή του corn steep liquor με βάση την βιβλιογραφία), το pH μεταξύ 4-6 και η θερμοκρασία μεταξύ 29 και 33 \( ^oC \) [cite:@zhugeGlycerolProductionNovel2001] . Για τα θρεπτικά συστατικά, βρέθηκε η ποσότητα νερού που απαιτείται για την παραγωγή διαλύματος γλυκόζης 230 g/l με όλη την γλυκόζη της διεργασίας και έπειτα η ποσότητα ουρίας και corn steep liquor (CSL) που απαιτείται ώστε οι συγκεντρώσεις τους να είναι οι επιθυμητές. Το pH δεν χρειάζεται να ρυθμιστεί σε κάποιο επίπεδο καθώς παρουσία του CSL το pH είναι στην επιθυμητή περιοχή ενώ η θερμοκρασία ρυθμίστηκε στους 30 \( ^oC \) καθώς για αυτή την τιμή υπάρχουν κινητικά δεδομένα [cite:@jinByproductFormationNovel2003] . Το CSL δεν προστέθηκε στην προσομοίωση της διεργασίας καθώς δεν υπάρχει στην βάση δεδομένων του Aspen και η πολυπλοκότητα της διεργασίας θα αυξανόταν σημαντικά με την προσθήκη του.

* Υπολογισμοί
Οι βασικοί υπολογισμοί του block 400 είναι 3. Η στοιχειομετρία της μικροβιακής αντίδρασης, η οποία δεν είναι γνωστή εξ'αρχής, η κινητική της μικροβιακής αντίδρασης και οι υπολογισμοί του εναλλάκτη. Οι υπολογισμοί του εναλλάκτη έγιναν απευθείας στο Aspen για αυτό θα επεξηγηθούν περισσότερο στην προσομοίωση. Για την στοιχειομετρία και την κινητική της μικροβιακής αντίδρασης, βασιστήκαμε σε πειραματικά δεδομένα [cite:@jinByproductFormationNovel2003; @zhugeGlycerolProductionNovel2001] . Ο προσδιορισμός της στοιχειομετρίας της αντίδρασης είναι μία περίπλοκη διαδικασία, ειδικά επειδή δεν είναι γνωστός εκ των προτέρων ο τύπος της βιομάζας. Υπάρχουν διάφορες τεχνικές που μπορούν να ακολουθηθούν για τον προσδιορισμό αυτόν, αλλά αποφασίστηκε πως αντί να υποτεθεί ο μοριακός τύπος της βιομάζας και να προκύψει μία αυθαίρετη μικροβιακή αντίδραση, να υπολογιστούν όσοι συντελεστές μπορούν με βάση τα πειραματικά δεδομένα για τα yields της αντίδρασης και να υπολογιστούν από αυτά ο τύπος της βιομάζας και όσοι στοιχειομετρικοί συντελεστές δεν είναι πειραματικά γνωστοί. Η αναλυτική επεξήγηση των υπολογισμών αυτών παρατίθεται σε σχετικό παράρτημα. Προκύπτει πως η αντίδραση είναι η

\[ 1.22 S + 0.24U + 2.89 O_2 \rightarrow 0.45 C_{1.48}H_{2.95}O_{0.048}N_{0.11} + G + 0.025E + 0.019Ac + 3.5CO_2 + 2.5H_2O \]
όπου S η γλυκόζη (υπόστρωμα), U η ουρία, G η γλυκερόλη, Ε η αιθανόλη και Ac το οξικό οξύ.

Για την κινητική της μικροβιακής αντίδρασης, έγινε προσαρμογή των παραπάνω πειραματικών δεδομένων στο μοντέλο Monod, το οποίο είναι το πιό κλασσικό μοντέλο για την μικροβιακή ανάπτυξη. Το πραγματικό κινητικό μοντέλο ενδέχεται να είναι πιό περίπλοκο από αυτό, αλλά απουσία μίας ολοκληρωμένης κινητικής μελέτης, το μοντέλο Monod είναι μία καλή πρώτη προσέγγιση. Ο ρυθμός με βάση το μοντέλο Monod είναι ο ρυθμός ανάπτυξης της βιομάζας. Με βάση την στοιχειομετρία όμως, ο ρυθμός της αντίδρασης ο οποίος θα χρησιμοποιηθεί στην διαστασιολόγηση του αντιδραστήρα θα είναι ο \( \frac{1}{0.45} \frac{dx}{dt} \).

Με βάση τα δεδομένα αυτά, το κινητικό μοντέλο που προέκυψε είναι το εξής:
\[ \frac{dx}{dt} = \frac{3.06*10^{-6}[S]}{236.19+[S]}[x] \] όπου οι σταθερές μ_max και K_s είναι υπολογισμένες σε μονάδες SI και οι συγκεντρώσεις σε g/l. Η προσαρμογή έγινε μέσω του Excel, το οποίο αρχείο μπορεί να βρεθεί [[https://github.com/Vidianos-Giannitsis/Process-Design/blob/master/Calculations/c_glycerinogenes_kinetics.ods][εδώ]].

* Προσομοιώσεις στο Aspen
Το μοντέλο που χρησιμοποιήθηκε για την προσομοίωση είναι το NRTL-HOC. Το μοντέλο NRTL είναι ένα από τα πιο σύνηθη μοντέλα συντελεστών ενεργότητας, το οποίο είναι κατάλληλο για χημικά συστήματα σε χαμηλή πίεση. Η τροποποίηση των Hayden O' Connell στο μοντέλο αυτό χρησιμοποιείται όταν υπάρχουν μικρά οργανικά οξέα στο διάλυμα. Τα οξέα αυτά έχουν την ιδιαιτερότητα να μπορούν να αλληλεπιδράσουν μεταξύ τους με δεσμούς υδρογόνου στην αέρια φάση ακόμη και σε χαμηλές πιέσεις. Λόγω αυτών των αλληλεπιδράσεων, η αέρια φάση δεν μπορεί να θεωρηθεί ιδανική και για αυτό απαιτείται κάποια διόρθωση στο μοντέλο NRTL, την οποία πετυχαίνουν μοντέλα όπως το NRTL-HOC.

Το ρεύμα εισόδου της διεργασίας ορίστηκε με βάση τις συγκεντρώσεις που αναφέρθηκαν παραπάνω ως βέλτιστες. Έπειτα, ορίστηκε νερό ως ο διαλύτης σε μία ποσότητα τέτοια ώστε να υπάρχει όση γλυκόζη στο ρεύμα όση πρέπει να υπάρχει με βάση το block 200. Για τον βιοαντιδραστήρα, ορίστηκε ότι θα λειτουργεί σε σταθερή πίεση και θερμοκρασία (30 \( ^oC \), 1 bar), με χρόνο λειτουργίας 80 ώρες (ο χρόνος που υπήρχε στα πειραματικά δεδομένα).

Για την κινητική, ορίστηκε η παραπάνω στοιχειομετρία, ενώ για την προσομοίωση του μοντέλου Monod, μπορεί να χρησιμοποιηθεί το μοντέλο LHHW με k=1, E=0, driving force τον αριθμητή του μοντέλου Monod και adsorption των παρανομαστή του. Αξίζει να αναφερθεί πως πρέπει οι μονάδες να είναι σε SI (όπως είναι στην προκειμένη περίπτωση) και στο Aspen πρέπει να μπούν οι λογάριθμοι των σταθερών και όχι οι ίδιες οι σταθερές. Επίσης, πρέπει να επιλεγεί το [C_i] basis στο μενού του driving force ως mass concentration για να έχουν οι συγκεντρώσεις τις σωστές μονάδες.

Για τον εναλλάκτη του block, πρακτικά μας ενδιαφέρει να ψύξουμε το ρεύμα της καθαρής γλυκερόλης καθώς έτσι και αλλιώς δεν θα επαρκέσει για να φτάσει το ρεύμα την επιθυμητή θερμοκρασία. Για αυτό ψάχνουμε την χαμηλότερη θερμοκρασία που μπορούμε να πάμε το ρεύμα, η οποία προκύπτει πως είναι 44 \( ^oC \), δηλαδή ένα ΔΤ = 14 \( ^oC \) από την είσοδο του ψυχρού. Τα προιόντα του αντιδραστήρα είναι σε αρκετά μεγαλύτερη παροχή από ότι το ρεύμα αυτό, για αυτό στην αρχή του block 500 ολοκληρώνεται η θέρμανση αυτή.

* Παράρτημα - Στοιχειομετρία Βιοαντιδραστήρα

Η βιοαντίδραση που θα χρησιμοποιηθεί είναι μία περίπλοκη αντίδραση της οποίας η στοιχειομετρία μπορεί πολύ δύσκολα να προσδιοριστεί ακριβώς. Επειδή απαιτείται μία έκφραση χημικής αντίδρασης για να μπεί στο ασπεν, θα γίνει μία προσέγγιση της παραγωγής προιόντων με βάση τις ποσότητες που παράγονται. Η αντίδραση που θα υποτεθεί είναι η
\[ S + U + C \rightarrow G + Ar + E + Ac\]
όπου S = γλυκόζη (substrate), U = ουρία, C = CSL, G = γλυκερόλη, Ar = αραβιτόλη, Ε = αιθανόλη, Ac = οξικό οξύ
δηλαδή πως η γλυκόζη "διασπάται" σε γλυκερόλη, αιθανόλη, οξικό οξύ και αραβιτόλη.

Στην πράξη η αντίδραση αυτή είναι αερόβια (πρέπει να υπάρχει οξυγόνο στα αντιδρώντα), αφορά την ανάπτυξη ενός μικροοργανισμού (πρέπει να υπάρχει βιομάζα στα προιόντα) και θα έχει και νερό και CO_2 ως προιόντα όπως όλες οι μικροβιακές αντιδράσεις. Λόγω έλλειψης δεδομένων, στο ασπεν, η αντίδραση θα μοντελοποιηθεί με βάση το παραπάνω.

Στην αντίδραση συμμετέχουν 32692.2 tn γλυκόζη, 283.74 tn ουρία και 567.57 tn CSL. Όμως, βάση προηγούμενων παραδοχών, έχουμε πει πως δεν αντιδρά όλη η ουρία και όλο το CSL. Έχουμε υποθέσει ότι αντιδρούν τα 3/4 της ουρίας και το μισό CSL. Άρα, 212.8 tn ουρία και 283.79 tn CSL. Τα προιόντα είναι 13643 tn γλυκερόλη, 640.68 tn αραβιτόλη, 168.82 tn αιθανόλη και 165.99 tn οξικό οξύ. Αρχικά, πρέπει να μετατρεπούν οι ποσότητες αυτές σε mol και έπειτα, από τις αναλογίες τους να βρεθούν οι συντελεστές. Ως βάση των υπολογισμών θα χρησιμοποιηθεί το 1 mol γλυκερόλης.

Οι [[https://github.com/Vidianos-Giannitsis/Process-Design/blob/master/Calculations/bioreactor_stoichiometry.m][σχετικοί υπολογισμοί]] φαίνονται στο ομώνυμο αρχείο matlab στον φάκελο /Calculations.

Η στοιχειομετρία της αντίδρασης που προκύπτει είναι
\[ 1.22S + 0.024U + 0.049C \rightarrow G + 0.028Ar + 0.025E + 0.019Ac \]
Αξίζει να αναφερθεί πως το CSL ορίστηκε ως ένα συστατικό με την σύσταση που φαίνεται στον παρακάτω πίνακα από την οποία προκύπτει ο εμπειρικός τύπος
\( C_{0.94}H_{2.94}O_{1.41}N_{0.04}P_{0.03}K_{0.03} \)
#+CAPTION: Σύσταση του CSL στα συστατικά του
| Συστατικό             | Περιεκτικότητα |
|-----------------------+----------------|
| Νερό                  |            0.6 |
| Γαλακτικό Οξύ         |           0.15 |
| Ζάχαρες σε ισοδύναμη  |           0.05 |
| συγκέντρωση γλυκόζης  |                |
| Τέφρα                 |            0.1 |
| Αμινοξέα σε ισοδύναμη |           0.03 |
| συγκέντρωση αλανίνης  |                |
| Αμμωνία               |           0.01 |
| Φώσφορος              |           0.03 |
| Κάλιο                 |           0.03 |
|-----------------------+----------------|
| Άθροισμα              |              1 |

Αξίζει να αναφερθεί πως στον πίνακα αυτό έχουν υπερεκτιμηθεί ορισμένα από τα συστατικά σε σχέση με τις τιμές τους στην αντίστοιχη βιβλιογραφία [cite:@liggettCORNSTEEPLIQUOR]. Αυτό συμβαίνει επειδή με βάση τις τιμές εκείνες ήταν αδύνατον να αθροιστούν τα συστατικά στη μονάδα.

Εφόσον στην αντίδραση αυτή δεν έχουν συμπεριληφθεί O_2 στα αντιδρώντα και βιομάζα, H_2O και CO_2 στα προιόντα, δεν θα κλείνουν τα στοιχειακά ισοζύγια για την αντίδραση. Απουσία άλλων δεδομένων, οι συντελεστές Ο_2, CO_2, H_2O και βιομάζας θα ληφθούν όλοι ίσοι με την μονάδα και ο τύπος της βιομάζας θα προκύψει έτσι ώστε να κλείνει το ισοζύγιο. Αν συμπεριληφθούν O_2 στα αντιδρώντα και CO_2, H_2O στα προιόντα όλα με συντελεστή μονάδα, τότε προκύπτει πως η βιομάζα θα έχει τύπο \( C_{3.167}H_{4.333}O_{3.217}N_{0.05} \). Άρα, η συνολική μικροβιακή αντίδραση που διεξάγεται θα είναι η
\[ 1.22S + 0.24U + 0.049C + O_2 \rightarrow C_{3.167}H_{4.333}O_{3.217}N_{0.05} + G + 0.028Ar +0.025E + 0.019Ac + H_2O +CO_2 \]

Σε πρώτη φάση, μπορεί η προσωμοίωση να γίνει στην απλουστευμένη περίπτωση ότι γλυκόζη και οξυγόνο, δίνουν γλυκερόλη, διοξείδιο του άνθρακα και νερό, κυρίως για να εξοικειωθώ με τους batch αντιδραστήρες στο ασπεν και να δοκιμάσω κάτι. Σε επόμενη φάση θα αναλυθεί η παραπάνω συνολική αντίδραση και οι διαχωρισμοί που απαιτεί. Για την στοιχειομετρία της αντίδρασης \( C_6H_{12}O_6 + O_2 \rightarrow C_3H_8O_3 + CO_2 +H_2O \) έχουμε 2 βαθμούς ελευθερίας ενώ οι υπόλοιποι συντελεστές καθορίζονται από τα mass balances C, H, O. Αν υποθέσουμε ότι οι συντελεστές γλυκερόλης και γλυκόζης είναι ίδιοι με αυτούς της συνολικής αντίδρασης τότε έχουμε ένα πλήρως ορισμένο σύστημα. Και καθώς αυτά τα δύο προκύπτουν από τα ίδια πειραματικά δεδομένα με την κινητική, είναι μία έγκυρη πηγή. Άρα, σε πρώτη φάση θα εξεταστεί η αντίδραση
\( 1.22 C_6H_{12}O_6 + 3.82O_2 \rightarrow C_3H_8O_3 + 4.32CO_2 + 3.32H_2O \) .

Όπως έχει αναφερθεί στα αρχεία των σχετικών προσομοιώσεων, ο ρυθμός της αντίδρασης αυτής είναι πολύ μεγαλύτερος από ότι θα έπρεπε με αποτέλεσμα η αντίδραση να τελειώνει σε μισή ώρα. Μάλλον, αυτό που φταίει είναι ότι παράγεται πολύ βιομάζα. Όμως, διαπιστώθηκε πως ο συντελεστής της βιομάζας δεν είναι πραγματικά μονάδα, αλλά ξέρουμε την τελική συγκέντρωση της βιομάζας στον αντιδραστήρα. Όμως, δεν μπορούμε να ξέρουμε τον ακριβή στοιχειομετρικό συντελεστή αν δεν ξέρουμε τον μοριακό τύπο, για αυτό η γνώση αυτή προσθέτει μία παραπάνω εξίσωση. Ακόμη, ξέρουμε πως ο αντιδραστήρας λειτουργεί τυπικά με αερισμό 0.1-0.5 vvm (volume of air per volume of liquid per minute). Άρα, είναι γνωστός ο συντελεστής του οξυγόνου και δεν αποτελεί άγνωστο. Άρα, οι εξισώσεις που διαμορφώνονται είναι 5 με 7 αγνώστους.

Το σύστημα είναι ως εξής
\[ \begin{align*} 4.167 = SbCb + S_{CO2} \\ 6.333 = SbHb + 2S_{H_2O} \\ 4.94 = SbOb + 2S_{CO2} + S_{H_2O} \\ 0.05 = SbNb \\ Sb = \frac{10.385}{12Cb+16Ob+Hb+14Nb}    \end{align*} \]

Η επίλυση του συστήματος αυτού είναι αρκετά δύσκολη και έγινε με την fsolve του Matlab. Λόγω της πολυπλοκότητας του συστήματος, απαιτείται αρκετό trial and error για να βρεθεί το σύστημα σε μία ευσταθή λύση και ακόμη περισσότερο για να βρεθεί λύση που έχει νόημα (όλοι οι άγνωστοι είναι θετικοί και ο στοιχειομετρικός συντελεστής βιομάζας είναι μικρότερος του 1). Στο trial and error αυτό, μεταβαλλόντουσαν όχι μόνο οι αρχικές συνθήκες του αλγορίθμου αλλά και οι βαθμοί ελευθερίας του συστήματος. Καθώς οι συντελεστές CO_{2} και H_{2}O προκαλούν του ίδιου τύπου μεταβολές στο σύστημα και η αύξηση τους οδηγεί απομάκρυνση από το σημείο ισορροπίας μετά από ένα σημείο, θεωρήθηκε απαραίτητο να μεταβληθεί και η παροχή οξυγόνου και να μην χρησιμοποιηθεί η βιβλιογραφική.

Το σύστημα μπόρεσε να συγκλίνει για τις εξής τιμές των 8 αγνώστων:
| Άγνωστος |   Τιμή |
|----------+--------|
| S_b      | 0.4519 |
| C_b      |   1.48 |
| H_b      |   2.95 |
| O_b      |  0.048 |
| N_b      |   0.11 |
| S_{O2}   |   2.89 |
| S_CO2    |    3.5 |
| S_{H2O}  |    2.5 |
και αρχικές τιμές S_b = 5, C_b = 0.208, H_b = 0.3165, O_b = 0.247, N_b = 2.5e-4. Είναι σίγουρο πως το σύστημα έχει πολλές λύσεις και αυτή δεν είναι η μοναδική που βγάζει νόημα, αλλά εφόσον βρέθηκα κάποια που βγάζει και λόγω της πολυπλοκότητας που εμπεριέχεται στο να βρεί κανείς μία λογική λύση για το σύστημα αυτό, η προσομοίωση θα προχωρήσει με αυτό.

Για το σύστημα αυτό όμως δεν ισχύει το συνολικό ισοζύγιο μάζας, παρόλο που ικανοποιούνται όλα τα μερικά. Το συνολικό ισοζύγιο μάζας ικανοποιείται αν και μόνο αν \[ 117.38 + 32S_O = 44S_{CO2} + 18S_{H_2O} \]. Η ποσότητα βιομάζας είναι γνωστή και είναι 10.385. Αλλά ανάλογα με το Sb που βγαίνει, πρέπει να επιβεβαιώσουμε ότι το σύστημα έχει δώσει το κατάλληλο μοριακό βάρος για να είναι το γινόμενο τους 10.385. Διατηρώντας σταθερά τα S_CO_{2} και S_{H2O} που χρησιμοποιήθηκαν παραπάνω, βρέθηκε πως πρέπει το S_{O2} να είναι 2.55. Δίνοντας τους βαθμούς ελευθερίας αυτούς στο παραπάνω σύστημα και επιλύοντας το με αρχική τιμή τη προηγούμενη λύση, ο αλγόριθμος κάνει exit με τον κωδικό 3, που σημαίνει ότι δεν κατάφερε να συγκλίνει σε λύση επειδή η επαναληπτική διαδικασία ξεπέρασε το tolerance της. Όμως, το σφάλμα στην επίλυση είναι αρκετά μικρό. Αν αλλάξουμε τον άνθρακα της λύσης που δίνει έτσι ώστε το μοριακό βάρος να βγαίνει τέτοιο ώστε να ισχύει το συνολικό ισοζύγιο μάζας, τότε μάλλον είμαστε καλά. Δοκιμάζοντας αυτό παίρνουμε τον παρακάτω πίνακα για τις μεταβλητές του συστήματος.
| Άγνωστος |   Τιμή |
|----------+--------|
| S_b      | 0.1087 |
| C_b      |  6.225 |
| H_b      | 12.369 |
| O_b      | 0.1133 |
| N_b      | 0.4736 |
| S_{O2}   |   2.55 |
| S_CO2    |    3.5 |
| S_{H2O}  |    2.5 |

Περνόντας τα καινούργια αυτά δεδομένα στο ασπεν και επιβεβαιώνοντας ότι η παροχή οξυγόνου στην τροφοδοσία επαρκεί για την αντίδραση (και δεν είναι σε μεγάλη περίσσεια επειδή δεν υπάρχει λόγος), το ασπεν τρέχει κανονικά την προσομοίωση και βγάζει τα σωστά αποτελέσματα για την ροή μάζας της βιομάζας του μικροοργανισμού στην έξοδο του αντιδραστήρα. Αξίζει να σημειωθεί πως για να είναι σωστός ο ρυθμός της αντίδρασης, πρέπει να διαιρέσουμε την σταθερά στο driving force με τον στοιχειομετρικό συντελεστή της βιομάζας καθώς ο ρυθμός που έχει εισαχθεί είναι ο ρυθμός παραγωγής βιομάζας (μοντέλο Monod). Ο χρόνος παραμονής που προκύπτει δεν έχει καμία απολύτως σχέση και πάλι, αλλά πλέον η προσομοίωση είναι σίγουρα (περίπου, κανείς δεν είναι βέβαιος ποιά είναι η πραγματική λύση του συστήματος) σωστή. 

* Βιβλιογραφία
#+print_bibliography:
